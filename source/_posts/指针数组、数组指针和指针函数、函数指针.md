---
title: 指针数组、数组指针和指针函数、函数指针
date: 2018-06-06 08:14:12
tags:
categories: linux
thumbnail: https://teddysun.com/wp-content/uploads/2014/Linux.jpg
---

    今天总结一下指针与函数和数组结合时产生的一些容易让人混淆的数据类型。
    其实认清指针、函数、数组的本质这也就不是问题了，之前每太搞清楚，这里总结一下。

## 概念

指针是什么？指针就是用于存放一块内存区域的**头地址**的变量（注意头地址），通常称为该指针指向该内存空间。只不过这个变量有类型之分，比如int类型的指针指向的是存放int型数据的内存地址，char型指针指向的是存放char类型数据的内存地址。

数组是什么？数据就是程序预先开辟出固定空间大小的内存区域，用于存放特定书类型数据的一块内存空间，通常用数组名来表示该内存空间的头地址，注意这里说的是头地址，既然是头地址，那么跟我们刚才说的指针是不是就很相似，其实他们就是一样的，所以我们可以看到指针和数组之间经常会混合使用，直接把一个数组当做指针传递出去或者使用。

函数是什么呢？函数就是我们用于将特定功能的代码集合到一个代码段中的一种书写和使用方式，其实我们这里说的不是函数是什么，准确地说是函数名是什么？

函数名其实也是一个指针，只不过它指向的地址是函数在被执行时所被加载到的内存地址，只不过这个指针是指向的函数地址。

## 组合类型

指针与函数以及指针与数组可以组合成四种不同的数据类型，分别是指针数组、数组指针、指针函数和函数指针。

### 指针数组

指针数组的定义：

```
int *p[10]    //分配一个大小为10的数组，数组内存放的是int型指针
```

相当于（这里涉及到C语言运算符优先级，可以了解一下）：

```
int *(p[10])
```

指针数组是数组，数组内存放的是int型（根据定义）指针。


### 数组指针

数组指针的定义：

```
int (*p)[10]
```

通过定义就可以看到，p被指定为了指针的形式（因为它和\*都在括号内，而括号的优先级比[ ]高），所以p是一个指针，指向存放了一个包含10个int型数据的数组的内存地址的头地址。

p是直接指向数组内存地址的，不是指向数组内所存放的int型数据的地址，这一点要搞清楚，当然我们可以通过p找到数组内每一个数据的内存地址，但是单单讲p这个指针的话，它是指向数组的内存地址的。

（回头补上个图片，应该会比较好理解一点）

p是指向数组所在内存地址的指针（也就是说p是存放数组内存地址的地址，可能这句话有点绕，然是认真理解一下），对于p来说，这一整块数组内存是一个整体，所以可以认为p的类型是数组类型，当然这不科学，因为我们没有讲过数组类型的数据，我这里是为了方便理解所以这么叫的。如果指针移动，它是以数组整个大小为单位进行移动的。

数组指针通常和二维数组联系比较紧密，因为二者可以相互转换。比如：

```
int a[5][10]
int (*p)[10]
p = a
```
思考一下，为什么a[i][j]可以用:

```
(*(p+i))[j], *(p[i] + j), *(*(p+i) + j), p[i][j]
```

### 指针函数

指针函数的定义：

```
int *func(int, int)
```

这就是我们常用的函数，只不过他的返回值是一个int型的指针。所以，指针函数就是一个函数，普普通通的函数，唯一的限制条件就是它要返回一个int类型（根据具体指针函数的定义）的指针。

就不多介绍了。


### 函数指针

函数指针的定义：

```
int (*func)(int, int)
```

看出区别没，func和\*被放在了同一个圆括号内，以此强调func是一个指针（因为\*离它最近，所以它是指针类型，上面的指针函数func前面是\*后面是(，由于fucn()的运算优先级高于\*func，所以func是一个函数），所以说func是一个指针，指向func函数的内存地址，注意这里的func是没有定义类型的，所以默认是void类型。

有一个点需要注意，func是函数名，单独使用时也表示函数的内存地址，也就是

假如我们定义一个函数指针变量：

```
void (*func_copy)(int, int) = NULL
```

这个函数指针是指向空的，func和func_copy都是函数指针，那么我们岂不是可以直接用func来给func_copy赋值？当然可以：

```
func_copy = func;
```

这样func_copy就也指向func这个函数的地址空间了，使用\*func_copy(int, int)就相当于调用fucn(int, int)啦。


## 总结

指针存储一块内存区域地址的变量，通常称为指针指向该内存区域，当然他可以指向存储数组和函数的内存空间，这就引出了指针与数组和函数的结合。

函数如果返回的是一个指针，那么我们就称之为指针函数，这个很好理解。

函数指针是用于指向一个void类型的指针，指向一个函数的内存地址，通常函数名就是用于表示函数的内存地址，所以我们可以用对应的函数名为函数指针赋值，注意这里说的对应的函数名是指该函数的参数个数和类型以及函数返回值都与该函数指针相同才行。

指针数组就是一个数组用来存放很多个特定类型的指针，这也很好理解。

数组指针就是指针指向一个存储固定大小数组的内存区域，需要注意的是这块内存区域对于数组指针来说是一个整体，要想获取该数组内的某一个数据，需要先找到改数组，也就是对数组指针解引用，得到该数组的内存地址，然后根据数组类型获取数组内固定位置的数据。

关于指针这块儿有点绕，但是万变不离其宗，理解指针的本质是理解这一切的关键，它就是存放内存地址的一个变量！

2018-6-6 北京，略阴